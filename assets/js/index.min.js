!function(){$(document).bind("click",function(h){if($(h.target).closest("#search-choice").length==0){$("#search-engin-list").hide()}else{$("#search-engin-list").toggle()}});var c=b("search_engin");if(c){g(c)}$("#search-engin-list .engin").click(function(){var h=$(this).attr("engin");g(h);e("search_engin",h)});$("#colorModal .item").click(function(){var h=$(this).attr("color");$("body").css("background-color",h);$(this).addClass("selected").siblings().removeClass("selected");e("bgcolor",h)});function g(i){var m=$(".engin[engin='"+i+"']");var l=m.find("img").attr("src");var k=m.attr("action");var j=m.attr("engin");var h=m.attr("key");$("#choice-btn").css("background-image","url("+l+")");$("#search-check").attr("action",k);$("#search-input").attr("name",h)}function e(h,j){if(j){var i=365;var k=new Date();k.setTime(k.getTime()+i*24*60*60*1000);document.cookie=h+"="+escape(j)+";expires="+k.toGMTString()}}function b(i){if(document.cookie.length>0){var j=document.cookie.indexOf(i+"=");if(j!==-1){j+=i.length+1;var h=document.cookie.indexOf(";",j);if(h===-1){h=document.cookie.length}return unescape(document.cookie.substring(j,h))}}return null}$(".go-login").click(function(){$("#login .login-form").show();$("#login .register-form").hide();$("#login .go-register").show();$("#login .go-login").hide();$("#login .title").html("登录")});$(".go-register").click(function(){$("#login .register-form").show();$("#login .login-form").hide();$("#login .go-login").show();$("#login .go-register").hide();$("#login .title").html("注册")});var f=window.location.host;var d={selector:".sort",finish:function(h){},};$("#sites").sortable(d);$("#search-check").submit(function(n){var o=$("#search-input").val();var j=["京东","京东商城","jd","jingdong"];var m=j.indexOf(o);if(m>=0){document.getElementById("site-jingdong").click();return false}var i=["淘宝","淘宝网","爱淘宝","taobao"];var l=i.indexOf(o);if(l>=0){document.getElementById("site-aitaobao").click();return false}var h=["天猫","tmall","tianmao"];var k=h.indexOf(o);if(k>=0){document.getElementById("site-tianmao").click();return false}});var a=$("#search-input");a.keyup(function(h){if(a.val()==""||a.val()==" "){var i=$("#index #search .keyword");i.animate({height:0},10,function(){i.css({display:"none",height:"auto"});i.empty()});return false}if(h.which!=39&&h.which!=40&&h.which!=37&&h.which!=38&&h.which!=13){$.ajax({url:su_url,type:"GET",dataType:"jsonp",jsonp:"jsoncallback",timeout:5000,data:{"wd":a.val(),"cb":"keydata"},success:function(j){},error:function(j){return}})}})}();function keydata(j){var f=j.s.length;var d=$("#index #search .keyword");var b=$("#search-input");var c=$("#search-submit");if(f==0){d.css({display:"none"})}else{d.css({display:"block"})}var g="";for(var e=0;e<f;e++){g+="<span>"+j.s[e]+"</span>"}d.html(g);d.animate({height:(d.children().height()+1)*f},100);d.children().click(function(){b.val($(this).html());d.animate({height:0},10,function(){d.css({display:"none",height:"auto"});d.empty()});b.focus();c.click()});c.focus(function(){d.animate({height:0},10,function(){d.css({display:"none",height:"auto"});d.empty()})});var a=0;b.keydown(function(l){if(l.which==13){d.animate({height:0},10,function(){d.css({display:"none",height:"auto"});d.empty()})}if(l.which==40){if(a==f){a=0}for(var k=0;k<f;k++){if(a==k){d.children().eq(k).css({"background-color":"#f1f1f1"})}else{d.children().eq(k).css({"background-color":"rgba(255,255,255,0.3)"})}}b.val(d.children().eq(a).html());a++}if(l.which==38){a--;if(a==f){a=0}for(var k=0;k<f;k++){if(a==k){d.children().eq(k).css({"background-color":"#f1f1f1"})}else{d.children().eq(k).css({"background-color":"rgba(255,255,255,0.3)"})}}b.val(d.children().eq(a).html())}});d.children().mouseover(function(){a=$(this).index();for(var k=0;k<f;k++){if(a==k){d.children().eq(k).css({"background-color":"#f1f1f1"})}else{d.children().eq(k).css({"background-color":"rgba(255,255,255,0.3)"})}}});var h=document.getElementsByTagName("body")[0];h.onclick=function(){d.animate({height:0},10,function(){d.css({display:"none",height:"auto"});d.empty()})}}function define(){$("#index .define").removeAttr("onclick");$("#index .drag").addClass("sort");var c='<li class="site addsite">'+'<a href="javascript:void(0)" data-toggle="modal" data-target="#addSite">'+'<img src="./assets/images/siteLogo/plus.png">'+'<span style="color: #15120e">添加网站</span>'+"</a>"+"</li>";$("#index .sites").append(c);var b='<div class="operation">'+'<i class="icon icon-pencil" onclick="editDefine($(this))" title="修改" data-toggle="modal" data-target="#editSite"></i>'+'<i class="icon icon-remove-sign" onclick="removeDefine($(this))" title="移除"></i>'+"</div>";$("#index .sites .drag").append(b);var a='<div class="define-op">'+'<div class="btn-group">'+'<button class="btn btn-warning" onclick="saveDefine()">保存</button>'+'<button class="btn btn-warning" onclick="location.reload()" >取消</button>'+'<button class="btn btn-info" onclick="defaultDefine()" >恢复默认</button>'+"</div>"+"</div>";
$("#index #sites").after(a)}$("#addSite .true").click(function(){var a=$("#addSite #site_name").val();var b=$("#addSite #site_url").val();if(a.length<1){new $.zui.Messager("请输入网站名称",{type:"warning",icon:"exclamation-sign",time:3000,}).show();return false}if(b.length<3){new $.zui.Messager("请输入网站地址",{type:"warning",icon:"exclamation-sign",time:3000,}).show();return false}$.ajax({url:define_icon_url,method:"post",data:{"_token":_token,"name":a,"url":b},success:function(d){if(d){var c=d}else{var c="./assets/images/siteLogo/default.png"}var e='<li class="site drag sort">'+'<a href="'+b+'" rel="nofollow" target="_blank">'+'<img src="'+c+'">'+"<span>"+a+"</span>"+"</a>"+'<div class="operation">'+'<i class="icon icon-pencil" onclick="editDefine($(this))" title="修改" data-toggle="modal" data-target="#editSite"></i>'+'<i class="icon icon-remove-sign" onclick="removeDefine($(this))" title="移除"></i>'+"</div>"+"</li>";$(".addsite").before(e);$("#addSite #site_name").val("");$("#addSite #site_url").val("");$("#addSite .close").click()}})});var adom;function editDefine(c){adom=c.parent().prev();var a=adom.attr("href");var b=adom.find("span").text();$("#editSite #site_name").val(b);$("#editSite #site_url").val(a);$("#editSite .true").click(function(){var d=$("#editSite #site_name").val();var e=$("#editSite #site_url").val();$.ajax({url:define_icon_url,method:"post",data:{"_token":_token,"name":d,"url":e},success:function(f){if(f){adom.find("img").attr("src",f)}adom.attr("href",e);adom.find("span").text(d);$("#editSite .close").click()}})})}function removeDefine(a){a.parent().parent().remove()}function showSiteBox(){var a=$("#box-open:checked").val();a=a=="on"?1:0;if(a>0){$(".box").show()}else{$(".box").hide()}}function saveDefine(){var a=0;var b=new Array();$("#sites .sort").each(function(){var c=$(this).find("a").attr("href");var d=$(this).find("a span").text();a+=1;b[a-1]={href:c,name:d,order:a}});$.ajax({url:define_save_url,method:"post",data:{"_token":_token,"defines":b},success:function(c){if(c.success){window.location.reload()}}})}function defaultDefine(){if(confirm("确认恢复网站到系统的默认设置吗？")){$.ajax({url:define_delete_url,method:"post",data:{"_token":_token},success:function(a){window.location.reload()}})}}$("#bgimg-btn").click(function(){$("#bgimg-input").trigger("click")});$("#bgimg-input").change(function(){if($(this).val()!=""){fileLoad(this)}});function fileLoad(c){var d=new FormData();var a=$(c).val();var b=$(c)[0].files[0];if(b.size>1048576){new $.zui.Messager("请上传1M内大小的图片",{type:"warning",icon:"exclamation-sign",time:2000,}).show();return false}d.append("file",b);d.append("name",a);d.append("_token",_token);$(".uping").show();$.ajax({url:bgimg_url,type:"POST",data:d,processData:false,contentType:false,beforeSend:function(){},success:function(e){$(".uping").hide();if(e.code){window.location.reload()}else{new $.zui.Messager(e.msg,{type:"warning",icon:"exclamation-sign",time:3000,}).show()}return false},error:function(e){$(".uping").hide();new $.zui.Messager("上传失败，请稍后尝试或留言反馈",{type:"warning",icon:"exclamation-sign",time:3000,}).show();return false}})}$("#deleteBgImg").click(function(){$.ajax({url:bgimg_del_url,type:"POST",data:{"_token":_token},success:function(a){if(a.code){window.location.reload()}else{new $.zui.Messager(a.msg,{type:"warning",icon:"exclamation-sign",time:3000,}).show()}return false}})});